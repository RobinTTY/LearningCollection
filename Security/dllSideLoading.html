<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<title data-react-helmet="true">DLL Side-Loading | Learning Collection Knowledge Base</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://RobinTTY.github.io/LearningCollection/Security/dllSideLoading"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="DLL Side-Loading | Learning Collection Knowledge Base"><meta data-react-helmet="true" name="description" content="- Category: Defense Evasion"><meta data-react-helmet="true" property="og:description" content="- Category: Defense Evasion"><link data-react-helmet="true" rel="shortcut icon" href="/LearningCollection/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://RobinTTY.github.io/LearningCollection/Security/dllSideLoading"><link data-react-helmet="true" rel="alternate" href="https://RobinTTY.github.io/LearningCollection/Security/dllSideLoading" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://RobinTTY.github.io/LearningCollection/Security/dllSideLoading" hreflang="x-default"><link rel="stylesheet" href="/LearningCollection/assets/css/styles.0c1eb2ef.css">
<link rel="preload" href="/LearningCollection/assets/js/runtime~main.29e04248.js" as="script">
<link rel="preload" href="/LearningCollection/assets/js/main.ddfae5b3.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/LearningCollection/"><img src="/LearningCollection/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/LearningCollection/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Learning Collection</b></a><a class="navbar__item navbar__link navbar__link--active" href="/LearningCollection/">Docs</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/LearningCollection/">Introduction</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">General Concepts</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">C-Sharp</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Web</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Databases</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Tools</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Linux</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Security</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/LearningCollection/Security/dataObfuscation">Data Obfuscation</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/LearningCollection/Security/trustedDeveloperUtilities">Trusted Developer Utilities Proxy Execution</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/LearningCollection/Security/dllSideLoading">DLL Side-Loading</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Interesting Topics</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>DLL Side-Loading</h1></header><ul><li>Category: Defense Evasion</li><li>Technique: Hijack Execution Flow</li><li>Goal: Execute malicious payload</li></ul><p>References:</p><ul><li>MITRE: <a href="https://attack.mitre.org/techniques/T1574/002/" target="_blank" rel="noopener noreferrer">Hijack Execution Flow: DLL Side-Loading</a></li><li>FireEye: <a href="https://www.mandiant.com/media/10376/download" target="_blank" rel="noopener noreferrer">DLL SIDE-LOADING: A THORN IN THE SIDE OF THE ANTI-VIRUS INDUSTRY - 2014</a></li></ul><p>DLL Side-Loading involves execution of a malicious payload in form of a DLL. Rather than just planting the DLL within the search order of a program (to await invocation by a user process) the adversaries may directly side-load the payload by invoking a legitimate application that executes the payload.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="traditional-dll-side-loading-on-windows"></a>Traditional DLL-Side loading on Windows<a class="hash-link" href="#traditional-dll-side-loading-on-windows" title="Direct link to heading">#</a></h2><ul><li>Windows, like many operating systems, allows applications to load DLLs at runtime</li><li>Applications can specify the location of DLLs by specifying a full path, using DLL redirection, or by using a manifest.</li><li>If none of these methods are used, Windows attempts to locate the DLL by searching a <strong>predefined set of directories</strong> in a set order</li><li>This fact can be abused by placing a malicious DLL in one of these directories<ul><li>In these cases Windows reaches the malicious DLL before finding the legitimate version</li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="less-common-variants"></a>Less common variants<a class="hash-link" href="#less-common-variants" title="Direct link to heading">#</a></h2><p>Another way to take advantage of DLL side-loading is by the way of Windows side-by-side (SxS or WinSxS) assembly feature.</p><p>This feature helps manage conflicting and
duplicate DLL versions by loading them on
demand from a common directory</p><p><img alt="Side-By-Side-Loading" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABBUAAAJpCAYAAADysQqHAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAJOgAACToAYJjBRwAABiUSURBVHhe7d2NbuM4mobRziDJlTX6ogd9ZUkBmRitwWa5tWa+l6R+nHOAwhiITVG0ogweSOqnj09/AAAAABT9a/tfAAAAgBJRAQAAAIiICgAAAEBEVAAAAAAiogIAAAAQERUAAACAiKgAAAAAREQFAAAAICIqAAAAABFRAQAAAIiICgAAAEBEVAAAAAAiogIAAAAQERUAAACAiKgAAAAAREQFAAAAICIqAAAAABFRAQAAAIiICgAAAEBEVAAAAAAiogIAAAAQERUAAACAiKgAAAAARJ4+Pm2v73p5fd5eAZB6f/u1vQIAgOtzpQIAAAAQERUAAACAiKgAAAAAROJnKrgvGKDPuRMAgEfmSgUAAAAgIioAAAAAEVEBAAAAiIgKAAAAQERUAAAAACKiAgAAABARFQAAAICIqAAAAABERAUAAAAgIioAAAAAEVEBAAAAiIgKAAAAQERUAAAAACKiAgAAABARFQAAAICIqAAAAABERAUAAAAgIioAAAAAEVEBAAAAiIgKAAAAQERUAAAAACKiAgAAABARFQAAAICIqAAAAABERAUAAAAgIioAAAAAEVEBAAAAiIgKAAAAQERUAAAAACKiAgAAABARFQAAAICIqAAAAABERAUAAAAgIioAAAAAEVEBAAAAiIgKAAAAQERUAAAAACKiAgAAABARFQAAAICIqAAAAABERAUAAAAgIioAAAAAEVEBAAAAiIgKAAAAQERUAAAAACKiAgAAABARFQAAAICIqAAAAABERAUAAAAgIioAAAAAEVEBAAAAiIgKAAAAQERUAAAAACKiAgAAABARFQAAAICIqAAAAABERAUAAAAgIioAAAAAEVEBAAAAiIgKAAAAQERUAAAAACKiAgAAABARFQAAAICIqAAAAABERAUAAAAgIioAAAAAEVEBAAAAiDx9fNpe3/Xy+ry9+sf726/tFQD/H+dOUu2xA0CNv7mwD1cqAAAAABFRAQAAAIiICgAAAEDEMxUWsV7/o7cWj75W1f1z7DwW3ycpxw5AjfMmHMOVCgAAAEBEVAAAAAAiogIAAAAQ8UyFSXrr85PX76cfO353fjbfPynHDkCN8yYcw5UKAAAAQERUAAAAACKiAgAAABDxTIVJeuszun7V8Vv3trdy7Jvq+NXxenrjtUbHn/35vdejOl6rut6Prvp9wn85dgBqnDfhGK5UAAAAACKiAgAAABARFQAAAICIZypM0luf0fVrP9/qjff18725tSpj31T3ffTnPVcb/2rzbY1+/tFYD1KOHYAa5004hisVAAAAgIioAAAAAEREBQAAACDimQqh0fWofn7m9trPrt6X1T+frd1e1ej8V6/H0eP/NNaDlGMHoMZ5E47hSgUAAAAgIioAAAAAEVEBAAAAiIgKk9zu4ar84zza7+Z2/13lHwAAwE8lKgAAAAARUQEAAACIiAoAAABARFT4ptH77nv/2vF7qu+vWDn2EWbvz+zxAAAArkpUAAAAACKiAgAAABARFQAAAIDI08en7fVd7b3jt+cA/CSr9783fvXnrXvzXTn2zei+tXrzafXGa1X3t7p/rbOtR3X7rdHPPxrrQcqxA1DjvAnHcKUCAAAAEBEVAAAAgIioAAAAAEQ8U+EiVq6/7xbW8ft1XUd/d4987LT7VlVdi9Vrebbv6pGPnaNZ23Pz/cAxXKkAAAAAREQFAAAAICIqAAAAABFRAQC+4Xav7r1/5G73PVf+WXsAOA9RAQAAAIiICgAAAEBEVAAAAAAiTx+fttd3tfcs3u5pBOA+587rmn2vfvW7f+RjZ/a+9cZbvZZn+672nE+7rZ7qXI4evx2vuraz59/bfnV+j+an7z8cxZUKAAAAQERUAAAAACKiAgAAABDxTAWAhar30/JzjN47fWWz96033uq1PNt3tef+Vsde/V3NHr99f+vo+beq23s0o+sPZFypAAAAAEREBQAAACAiKgAAAAARz1QAWMi587p69y5XVb/7Rz52Zu9bb7zVa3m272rP/a2OXZ1b+/6qdvzRtel9fnS+rdnzf3TWB47hSgUAAAAgIioAAAAAEVEBAAAAiHimAsBCzp3XVb03evZ3+8jHzux96423ei3P9l3tub/VsVd/V1cfv2f1+FdnfeAYrlQAAAAAIqICAAAAEBEVAOAbbpfR3vvHfm6XOH/957v4udpjYbbV47f23h7ADKICAAAAEBEVAAAAgIioAAAAAET8JyUBFnLuJPXIx87oveLVtZh9b3q7/dXjV+05n+q2Zn93ve+it72jx29Vx+u9/6exPnAMVyoAAAAAEVEBAAAAiIgKAAAAQMQzFQAWcu4k5dgBqHHehGO4UgEAAACIiAoAAABARFQAAAAAIqICAAAAEBEVAAAAgIioAAAAAEREBQAAACAiKgAAAAARUQEAAACIiAoAAABARFQAAAAAIqICAAAAEBEVAAAAgIioAAAAAEREBQAAACAiKgAAAAARUQEAAACIiAoAAABARFQAAAAAIqICAAAAEBEVAAAAgIioAAAAAEREBQAAACAiKgAAAAARUQEAAACIiAoAAABARFQAAAAAIqICAAAAEBEVAAAAgIioAAAAAEREBQAAACAiKgAAAAARUQEAAACIiAoAAABARFQAAAAAIqICAAAAEBEVAAAAgIioAAAAAEREBQAAACAiKgAAAAARUQEAAACIiAoAAABARFQAAAAAIqICAAAAEBEVAAAAgIioAAAAAEREBQAAACAiKgAAAAARUQEAAACIiAoAAABARFQAAAAAIk8fn7bXd728Pm+vAEi9v/3aXsF97d9dxw7Afc6bcAxXKgAAAAARUQEAAACIiAoAAABA5NvPVAAA9uPeYIAa5004hisVAAAAgIioAAAAAEREBQAAACAiKgAAAAARUQEAAACIiAoAAABARFQAAAAAIqICAAAAEBEVAAAAgIioAAAAAEREBQAAACAiKgAAAAARUQEAAACIiAoAAABARFQAAAAAIqICAAAAEBEVAAAAgIioAAAAAEREBQAAACAiKgAAAAARUQEAAACIiAoAAABARFQAAAAAIqICAAAAEBEVAAAAgIioAAAAAEREBQAAACAiKgAAAAARUQEAAACIiAoAAABARFQAAAAAIqICAAAAEBEVAAAAgIioAAAAAEREBQAAACAiKgAAAAARUQEAAACIiAoAAABARFQAAAAAIqICAAAAEBEVAAAAgIioAAAAAEREBQAAACDy9PFpe33Xy+vz9gqA1Pvbr+0V3Nf+3Z197Pi7Dhxt9XnN31zYhysVAAAAgIioAAAAAEREBQAAACASP1PBPUoAfc6dpPZ+psLf//57ewWwxp9//bm9+odnKsBjcKUCAAAAEBEVAAAAgIioAAAAAEREBQAAACAiKgAAAAARUQEAAACIiAoAAABARFQAAAAAIqICAAAAEBEVAAAAgIioAAAAAEREBQAAACAiKgAAAAARUQEAAACIiAoAAABARFQAAAAAIqICAAAAEBEVAAAAgIioAAAAAEREBQAAACAiKgAAAAARUQEAAACIiAoAAABA5Onj0/b6rpfX5+3VP97ffm2vmGH1+n4d/9G+u9G1e/Rj2+/usaw/qdXHTjv+3//+e3tV9+dff26vMiPbXuFs+9PO52rjw3+1x9rq85q/ubAPVyoAAAAAEVEBAAAAiIgKAAAAQMQzFU6iXd9Wdb3vjffTv7ufdiz73T2W9Se1+thpx6/cRz/7Hvyj7+k/+/6047Wq488eD76rPfZWn9f8zYV9uFIBAAAAiIgKAAAAQERUAAAAACKeqXAS7fq2qut9b7zeWL25tGaP16qO377/6P3pjdcaHX/1/KjpHZ+rHb19cqu/u3b8yn30s58Z0DO6vd7n996fqnZ+rdH1aPXG633+q5lj/c7sfW+tXtv2/bPXqzre6Px62vFWn9f8zYN9uFIBAAAAiIgKAAAAQERUAAAAACKeqXASvfWd+fPqZ3tG59Yze/zV72/Nnn9r9fiMWb3+7fg9vv/r2PvYGblXunef9+h92K3V94HvvT89o/u7+uf3rBz75mrjt+9vHT3/VnV7Pe32Vp/X/M2DfbhSAQAAAIiICgAAAEBEVAAAAAAinqlwEr31nfnz3nfXjlVVnVvP6L63Rt8/anR7s9ePtUbXf+/jj/NY/bvbjj/73umvVt+3PXrfedXR96G346/+eau3//eMbru159xv9p7/6Hxbs+df1W5v9XnN3zzYhysVAAAAgIioAAAAAEREBQAAACDimQon0VvfmT+vfrZndG49s8df/f7Vrj7/n2b0+4K9rL6X+p7V96XvbfZ8euMd/fN7Vo59Y/wxq8dvtdub/f9J/H8eOIYrFQAAAICIqAAAAABERAUAAAAg4pkKJzF633Xl/e17R7fdGh2/1fv86Pxnv781e/6t1eMzZvb3O8r3fx2rf3fb8Sv3Us++D7s6Xu/9s8erOvv6tHrvr4zXvrc1MvbvzJz7zer5rx6/1fv86PhV7fZWn9f8zYN9uFIBAAAAiIgKAAAAQERUAAAAACKeqXAS1fUdeX917Fb7+d5cqnNtzR5/9nx6jh6/N151ftSMHm89q49HjrP3sTNyL3XvPvGe3rZX31feWr0/VaPzX/3+r9rP9saubrs1c+43o/M7evxWdbze+0e121t9XvM3D/bhSgUAAAAgIioAAAAAEVEBAAAAiHimAsBCR587nbuva/V3146/+l5q4P/a+5kGR/NMBXhMrlQAAAAAIqICAAAAEBEVAAAAgIhnKgAs5NxJyjMV4PzaZwRU/bTfO89UgMfkSgUAAAAgIioAAAAAEVEBAAAAiHimAsBCzp2kPFMBeDSeqQCPyZUKAAAAQERUAAAAACKiAgAAABARFQAAAICIqAAAAABERAUAAAAgIioAAAAAEVEBAAAAiIgKAAAAQERUAAAAACKiAgAAABARFQAAAICIqAAAAABERAUAAAAgIioAAAAAEVEBAAAAiIgKAAAAQERUAAAAACKiAgAAABARFQAAAICIqAAAAABERAUAAAAgIioAAAAAEVEBAAAAiIgKAAAAQERUAAAAACKiAgAAABB5+vi0vb7r5fV5ewVA6v3t1/YK7mv/7s4+dvxdB462+rzmby7sw5UKAAAAQERUAAAAACKiAgAAABD59jMVAID9uDcYoMZ5E47hSgUAAAAgIioAAAAAEVEBAAAAiIgKAAAAQERUAAAAACKiAgAAABARFQAAAICIqAAAAABERAUAAAAgIioAAAAAEVEBAAAAiIgKAAAAQERUAAAAACKiAgAAABARFQAAAICIqAAAAABERAUAAAAgIioAAAAAEVEBAAAAiDx9fNpeAwAn8fL6vL0CIPH+9mt7BazkSgUAAAAgIioAAAAAEVEBAAAAiHimAgDAA2mfx3Gl+8qvPHeAn8qVCgAAAEBEVAAAAAAiogIAAAAQERUAAACAiKgAAAAAREQFAAAAICIqAAAAABFRAQAAAIiICgAAAEBEVAAAAAAiogIAAAAQERUAAACAiKgAAAAAREQFAAAAICIqAAAAABFRAQAAAIiICgAAAEBEVAAAAAAiogIAAAAQERUAAACAiKgAAAAAREQFAAAAICIqAAAAABFRAQAAAIiICgAAAEBEVAAAAAAiogIAAAAQERUAAACAiKgAAAAAREQFAAAAICIqAAAAABFRAQAAAIiICgAAAEBEVAAAAAAiogIAAAAQERUAAACAiKgAAAAAREQFAAAAICIqAAAAABFRAQAAAIiICgAAAEBEVAAAAAAiogIAAAAQERUAAACAiKgAAAAAREQFAAAAICIqAAAAABFRAQAAAIiICgAAAEBEVAAAAAAiogIAAAAQERUAAACAiKgAAAAAREQFAAAAICIqAAAAAJGnj0/bawDgm15en7dXcG7vb7+2V+fn94orudLvFqzkSgUAAAAgIioAAAAAEVEBAAAAiHimAgAE2nu/3VsL8Nic9+H3XKkAAAAAREQFAAAAICIqAAAAABFRAQAAAIiICgAAAEBEVAAAAAAiogIAAAAQERUAAACAiKgAAAAAREQFAAAAICIqAAAAABFRAQAAAIiICgAAAEBEVAAAAAAiogIAAAAQERUAAACAiKgAAAAAREQFAAAAICIqAAAAABFRAQAAAIiICgAAAEBEVAAAAAAiogIAAAAQERUAAACAiKgAAAAAREQFAAAAICIqAAAAABFRAQAAAIiICgAAAEBEVAAAAAAiTx+fttcA8GO9vD5vr/bx/vZrewXAEZz3YQ5XKgAAAAARUQEAAACIiAoAAABAxDMVAODT6ntr3UsLcC7O+zCHKxUAAACAiKgAAAAAREQFAAAAIOKZCgDwG7PvtXVvLcC5Oe9DxpUKAAAAQERUAAAAACKiAgAAABDxTAUA+I3Re2vdSwtwLc77kHGlAgAAABARFQAAAICIqAAAAABEPFMBAL6heq+te2sBrs15H77HlQoAAABARFQAAAAAIqICAAAAEPFMBQD4ht69te6lBXgszvvwPa5UAAAAACKiAgAAABARFQAAAICIZyoAp1b9b0QD8L9d6b5v53yAcXuf912pAAAAAEREBQAAACAiKgAAAAARz1QATq29v9Z/ExrgviufN53zAeqOPne6UgEAAACIiAoAAABARFQAAAAAIqICAAAAEBEVAAAAgIioAAAAAEREBQAAACAiKgAAAAARUQEAAACIiAoAAABARFQAAAAAIqICAAAAEBEVAAAAgIioAAAAAEREBQAAACAiKgAAAAARUQEAAACIiAoAAABARFQAAAAAIqICAAAAEBEVAAAAgIioAAAAAEREBQAAACDy9PFpew1wOi+vz9urf7y//dpeXUM7/56r7d+eZq9l9dgafX9P9bs/8tiqrkXV2db6alZ/Pytdee43jsW5Zq9n9fgafX9P9fs/+viqrkfF6rVuzV6bo638br7DlQoAAABARFQAAAAAIqICAAAAEPFMBeDUjr5HrGp0vlfb35VWr2V1/NnjtY4ev2LmWL9zpbU4oyvv39Xm7lica/V6VsefPV7r6PGrZo/3VXXslXO5oqPXw5UKAAAAQERUAAAAACKiAgAAABDxTAXg1M5+z9zR82u331O5R7F9b3Vbrcq2b2av5eha7T2/K40/Onb186vX6uquvD5nn/vR82u33zP6u1TdXmt0+6NG12vv+f2k8aufXb0vV3f0+rhSAQAAAIiICgAAAEBEVAAAAAAinqkAnNrZ76Hbe36j2+t9vv35V7339uZS3XZ136pmz7+n/XzrbPtbMXttqt9F1eq1PtrK73q1s8997/mNbq/3+fbnrd77e/Opbr+6f1Wz59/Tfr51tv2tGhl/9LuoWr3WR1v9Xfe4UgEAAACIiAoAAABARFQAAAAAIp6pAJza0feI9ew9v9Ht9T7/9ee9satzqWz7prpvVbPnP2r2+Huv51e9bY/O7ejPn92V9+/sc997fquP9er4s98/un9Vq/e3avb4e69n6972zzy3R3D0/rlSAQAAAIiICgAAAEBEVAAAAAAiogIAPIDb/ZRf/93up/z6D4DH4rzPWYgKAAAAQERUAAAAACKiAgAAABB5+vi0vQY4nds9gl+d/R7B0fn2Pr/n+L2xq3NZ/f5WZV9vRuezer6t0e3tafZc917rq7ny/l1t7quPxbONf7b3t/be39XzbY1ub29f5zs6173X+mqO3j9XKgAAAAARUQEAAACIiAoAAABAxDMVgFO7+j1w7fx7Ru8R7OmN/3W8yntvZr+/tXJff6f9/Oj+9swer6e6/iOqa1c1e62vbvV6r3Tlud+sPhZnj19d79Xvb63e31b7+dH97Zk9Xk91/Ud9nf/sbc9e66urHquzuVIBAAAAiIgKAAAAQERUAAAAACKeqQCc2tH3iAFczZXPm875AHWeqQAAAABckqgAAAAAREQFAAAAICIqAAAAABFRAQAAAIiICgAAAEBEVAAAAAAiogIAAAAQERUAAACAiKgAAAAAREQFAAAAICIqAAAAABFRAQAAAIiICgAAAEBEVAAAAAAiogIAAAAQERUAAACAiKgAAAAAREQFAAAAICIqAAAAABFRAQAAAIiICgAAAEBEVAAAAAAiogIAAAAQERUAAACAiKgAAAAAREQFAAAAICIqAAAAABFRAQAAAIiICgAAAEBEVAAAAAAiogIAAAAQERUAAACAiKgAAAAAREQFAAAAIPL08Wl7DXA6L6/P2ysAEu9vv7ZX5+ecDzBu7/O+KxUAAACAiKgAAAAAREQFAAAAIOKZCgAAAEDElQoAAABARFQAAAAAIqICAAAAEBEVAAAAgIioAAAAAEREBQAAACAiKgAAAAARUQEAAACIiAoAAABARFQAAAAAIqICAAAAEBEVAAAAgIioAAAAAEREBQAAACDwxx//Ab4aSAWzUfSJAAAAAElFTkSuQmCC"></p><ul><li>WinSxS mainfests, which are embedded in the executable as XML data, describe dependencies and libraries used by the application</li><li>WinSxS is designed to give developers flexibility to update binaries by easily replacing the old binaries in the same location</li><li>This omission may inadvertently grant trusted installer privileges to malicious payloads.</li></ul><p><img alt="Side-By-Side-Loading2" src="/LearningCollection/assets/images/Side-by-Side2-7f635ffe7896de357008c0a335baafc9.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="the-problem"></a>The problem<a class="hash-link" href="#the-problem" title="Direct link to heading">#</a></h3><p>The problem with this technique is that it offers little to no validation of the loaded DLL other than what is explicit in the manifestâ€™s DLL metadata.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="examples-of-dll-side-loading"></a>Examples of DLL Side-Loading<a class="hash-link" href="#examples-of-dll-side-loading" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="oceanlotus-kerrdown"></a>OceanLotus KerrDown<a class="hash-link" href="#oceanlotus-kerrdown" title="Direct link to heading">#</a></h3><ul><li>OceanLotus (APT32) is a sophisticated threat actor originating out of south east asia</li><li>KerrDown uses DLL Side-Loading to load <a href="https://www.infocyte.com/cyber-security/2020/09/02/cobalt-strike-the-new-favorite-among-thieves/" target="_blank" rel="noopener noreferrer">Cobalt Strike</a> beacons into memory</li></ul><p><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-6-Execution-flow-of-sideloaded-malicious-downloader.png" alt="KerrDown"></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="process"></a>Process<a class="hash-link" href="#process" title="Direct link to heading">#</a></h4><ul><li>Victim needs to open a lure document, which includes an image file with a message in Vietnamese which that asks the victim to enable macros to view the contents of the file
<img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-1-Lure-document.png" alt="Delivery"></li><li>Two different base64 blobs are inserted in the page in separate tables, the font size has been changed to 1 which may deceive victims to overlook the content<ul><li>this may be used to hide the content from automated tools which can detect the presence of an embedded binary within files</li></ul></li></ul><p><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/01/Figure-2-Base64-encoded-pedll-files-embedded-as-text-in-the-document..png" alt="Base64"></p><ul><li>Based on whether the system is 32-bit or 64-bit one of the two base64 encoded blobs gets executed by the embedded macro</li><li>We can see that the decoded blob begins with the header of a <a href="https://en.wikipedia.org/wiki/Portable_Executable" target="_blank" rel="noopener noreferrer">Portable Executable (PE)</a> DLL file</li><li>After decoding the DLL is dropped in the directory location <code>&#x27;Users\Administrator\AppData\Roaming\&#x27;</code> as &#x27;main_background.png&#x27;.</li><li>The DLL retrieves the payload from the URL, decrypts it executes it in the memory. Therefore, it is observed that only the KerrDown DLL downloader is saved in the system and the payload (Cobalt Strike Beacon) directly gets executed in the memory without being written in the system.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="mitigations"></a>Mitigations<a class="hash-link" href="#mitigations" title="Direct link to heading">#</a></h2><ul><li><strong>Application Developer Guidance:</strong> Train developers of applications so they know how to avoid introducing DLL Side-Loading vulnerabilities</li><li>Keep software up to date</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="detection"></a>Detection<a class="hash-link" href="#detection" title="Direct link to heading">#</a></h2><ul><li>Monitor running processes on your machine for unusual activity<ul><li>e.g. a process that does not usually use the network begins to do so</li></ul></li><li>Monitor the introduction of new files/programs</li><li>Track DLL metadata<ul><li>e.g. compute a hash of the DLL and validate it before loading it for process execution (you need to account for updates/patching)</li></ul></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/RobinTTY/LearningCollection/tree/master/website/docs/Security/DLL Side-Loading.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/LearningCollection/Security/trustedDeveloperUtilities"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Trusted Developer Utilities Proxy Execution</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/LearningCollection/Interesting Topics/interestingTopics"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Interesting Topics Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#traditional-dll-side-loading-on-windows" class="table-of-contents__link">Traditional DLL-Side loading on Windows</a></li><li><a href="#less-common-variants" class="table-of-contents__link">Less common variants</a><ul><li><a href="#the-problem" class="table-of-contents__link">The problem</a></li></ul></li><li><a href="#examples-of-dll-side-loading" class="table-of-contents__link">Examples of DLL Side-Loading</a><ul><li><a href="#oceanlotus-kerrdown" class="table-of-contents__link">OceanLotus KerrDown</a></li></ul></li><li><a href="#mitigations" class="table-of-contents__link">Mitigations</a></li><li><a href="#detection" class="table-of-contents__link">Detection</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">My other sites</div><ul class="footer__items"><li class="footer__item"><a href="https://robintty.github.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Socials</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/RobinTTY" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.linkedin.com/in/robin-m%C3%BCller-574782170/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Robin MÃ¼ller. Built with Docusaurus.</div></div></div></footer></div>
<script src="/LearningCollection/assets/js/runtime~main.29e04248.js"></script>
<script src="/LearningCollection/assets/js/main.ddfae5b3.js"></script>
</body>
</html>