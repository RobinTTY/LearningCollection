"use strict";(self.webpackChunklearning_knowledge_base=self.webpackChunklearning_knowledge_base||[]).push([[4212],{3905:(e,t,n)=>{n.d(t,{Zo:()=>l,kt:()=>u});var r=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var p=r.createContext({}),c=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},l=function(e){var t=c(e.components);return r.createElement(p.Provider,{value:t},e.children)},g="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,p=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),g=c(n),d=i,u=g["".concat(p,".").concat(d)]||g[d]||m[d]||o;return n?r.createElement(u,a(a({ref:t},l),{},{components:n})):r.createElement(u,a({ref:t},l))}));function u(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,a=new Array(o);a[0]=d;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s[g]="string"==typeof e?e:i,a[1]=s;for(var c=2;c<o;c++)a[c]=n[c];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},152:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>a,default:()=>m,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var r=n(7462),i=(n(7294),n(3905));const o={id:"integration-testing",title:"Integration Testing",sidebar_position:1},a=void 0,s={unversionedId:"csharp/entity-framework/testing/integration-testing",id:"csharp/entity-framework/testing/integration-testing",title:"Integration Testing",description:"When doing integration testing for an Entity Framework project it is a common approach to add an appsettings.json specific to the integration test environment in the application. While this approach can work, it makes more sense for the application to not have to know anything about the testing environment.",source:"@site/docs/csharp/entity-framework/testing/integration-testing.md",sourceDirName:"csharp/entity-framework/testing",slug:"/csharp/entity-framework/testing/integration-testing",permalink:"/LearningCollection/csharp/entity-framework/testing/integration-testing",draft:!1,editUrl:"https://github.com/RobinTTY/LearningCollection/tree/master/website/docs/csharp/entity-framework/testing/integration-testing.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{id:"integration-testing",title:"Integration Testing",sidebar_position:1},sidebar:"docs",previous:{title:"Entity types",permalink:"/LearningCollection/csharp/entity-framework/creating-a-model/entity-types"},next:{title:"Introduction",permalink:"/LearningCollection/csharp/libraries/hot-chocolate/introduction"}},p={},c=[{value:"Example",id:"example",level:2}],l={toc:c},g="wrapper";function m(e){let{components:t,...n}=e;return(0,i.kt)(g,(0,r.Z)({},l,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"When doing integration testing for an Entity Framework project it is a common approach to add an ",(0,i.kt)("inlineCode",{parentName:"p"},"appsettings.json")," specific to the integration test environment in the application. While this approach can work, it makes more sense for the application to not have to know anything about the testing environment."),(0,i.kt)("p",null,"Instead we can override the configuration of the host in the test project to achieve the same result. This way all the tesing configuration is in the test project and the application does not need to know anything about the testing environment."),(0,i.kt)("h2",{id:"example"},"Example"),(0,i.kt)("p",null,"We override the ",(0,i.kt)("inlineCode",{parentName:"p"},"ConfigureWebHost")," method in the ",(0,i.kt)("inlineCode",{parentName:"p"},"WebApplicationFactory")," class to override the configuration of the host."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-csharp"},"  protected override void ConfigureWebHost(IWebHostBuilder builder)\n  {\n      builder.ConfigureTestServices(services =>\n      {\n          services.RemoveAll<DbContextOptions<AppDbContext>>();\n          services.RemoveAll<AppDbContext>();\n\n          services.AddDbContext<AppDbContext>(x =>\n              x.UseNpgsql(_dbContainer.GetConnectionString()));\n      });\n  }\n")),(0,i.kt)("admonition",{type:"danger"},(0,i.kt)("p",{parentName:"admonition"},"Never use the ",(0,i.kt)("inlineCode",{parentName:"p"},"InMemoryDatabase")," for integration testing. The behvaior is not comparable to the real database since the conversion of the LINQ queries to SQL and translation of data is not tested.")),(0,i.kt)("p",null,"See this ",(0,i.kt)("a",{parentName:"p",href:"https://www.youtube.com/watch?v=K1-n2EoPxiY"},"Nick Chapsas Video")," for more details."))}m.isMDXComponent=!0}}]);