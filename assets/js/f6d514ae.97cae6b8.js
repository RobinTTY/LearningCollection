"use strict";(globalThis.webpackChunklearning_knowledge_base=globalThis.webpackChunklearning_knowledge_base||[]).push([[6839],{12256:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>s,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"csharp/entity-framework/creating-a-model/value-converters","title":"Value Converters","description":"Value converters allow property values to be converted when reading from or writing to the database. This conversion can be","source":"@site/docs/csharp/entity-framework/creating-a-model/value-converters.md","sourceDirName":"csharp/entity-framework/creating-a-model","slug":"/csharp/entity-framework/creating-a-model/value-converters","permalink":"/LearningCollection/csharp/entity-framework/creating-a-model/value-converters","draft":false,"unlisted":false,"editUrl":"https://github.com/RobinTTY/LearningCollection/tree/master/website/docs/csharp/entity-framework/creating-a-model/value-converters.md","tags":[],"version":"current","frontMatter":{"title":"Value Converters"},"sidebar":"docs","previous":{"title":"Relationships","permalink":"/LearningCollection/csharp/entity-framework/creating-a-model/relationships"},"next":{"title":"Basic Querying","permalink":"/LearningCollection/csharp/entity-framework/querying-data/basic-querying"}}');var o=r(74848),i=r(28453);const s={title:"Value Converters"},a=void 0,l={},c=[{value:"Configuring a value converter",id:"configuring-a-value-converter",level:2},{value:"The ValueConverter class",id:"the-valueconverter-class",level:2},{value:"Built-in converters",id:"built-in-converters",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.p,{children:"Value converters allow property values to be converted when reading from or writing to the database. This conversion can be"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["from one value to another of the ",(0,o.jsx)(n.strong,{children:"same type"})," (for example, encrypting strings)."]}),"\n",(0,o.jsxs)(n.li,{children:["or from a value of one type to a value of ",(0,o.jsx)(n.strong,{children:"another type"})," (for example, converting enum values to and from strings in the database)."]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["Value converters are specified in terms of a ",(0,o.jsx)(n.code,{children:"ModelClrType"})," and a ",(0,o.jsx)(n.code,{children:"ProviderClrType"}),":"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"The model type is the .NET type of the property in the entity type."}),"\n",(0,o.jsx)(n.li,{children:"The provider type is the .NET type understood by the database provider."}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"configuring-a-value-converter",children:"Configuring a value converter"}),"\n",(0,o.jsxs)(n.p,{children:["Value conversions are configured in ",(0,o.jsx)(n.code,{children:"DbContext.OnModelCreating"}),". For example, consider an enum and entity type defined as:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-csharp",children:"public class Rider\n{\n    public int Id { get; set; }\n    public EquineBeast Mount { get; set; }\n}\n\npublic enum EquineBeast\n{\n    Donkey,\n    Mule,\n    Horse,\n    Unicorn\n}\n\nprotected override void OnModelCreating(ModelBuilder modelBuilder)\n{\n    modelBuilder\n        .Entity<Rider>()\n        .Property(e => e.Mount)\n        .HasConversion(\n            v => v.ToString(),\n            v => (EquineBeast)Enum.Parse(typeof(EquineBeast), v));\n}\n"})}),"\n",(0,o.jsx)(n.h2,{id:"the-valueconverter-class",children:"The ValueConverter class"}),"\n",(0,o.jsxs)(n.p,{children:["Calling ",(0,o.jsx)(n.code,{children:"HasConversion"})," as shown above will create a ",(0,o.jsx)(n.code,{children:"ValueConverter<TModel,TProvider>"})," instance and set it on the property. The ",(0,o.jsx)(n.code,{children:"ValueConverter"})," can instead be created explicitly. For example:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-csharp",children:"protected override void OnModelCreating(ModelBuilder modelBuilder)\n{\n    var converter = new ValueConverter<EquineBeast, string>(\n        v => v.ToString(),\n        v => (EquineBeast)Enum.Parse(typeof(EquineBeast), v));\n\n    modelBuilder\n        .Entity<Rider>()\n        .Property(e => e.Mount)\n        .HasConversion(converter);\n}\n"})}),"\n",(0,o.jsx)(n.p,{children:"This can be useful when multiple properties use the same conversion."}),"\n",(0,o.jsx)(n.h2,{id:"built-in-converters",children:"Built-in converters"}),"\n",(0,o.jsxs)(n.p,{children:["EF Core ships with a set of pre-defined ",(0,o.jsx)(n.code,{children:"ValueConverter<TModel,TProvider>"})," classes, found in the ",(0,o.jsx)(n.code,{children:"Microsoft.EntityFrameworkCore.Storage.ValueConversion"})," namespace. In many cases EF will choose the appropriate built-in converter based on the type of the property in the model and the type requested in the database."]}),"\n",(0,o.jsxs)(n.p,{children:["For example, using ",(0,o.jsx)(n.code,{children:".HasConversion<int>()"})," on a ",(0,o.jsx)(n.code,{children:"bool"})," property will cause EF Core to convert ",(0,o.jsx)(n.code,{children:"bool"})," values to numerical zero and one values:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-csharp",children:"protected override void OnModelCreating(ModelBuilder modelBuilder)\n{\n    modelBuilder\n        .Entity<User>()\n        .Property(e => e.IsActive)\n        .HasConversion<int>();\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["This is functionally the same as creating an instance of the built-in ",(0,o.jsx)(n.code,{children:"BoolToZeroOneConverter<TProvider>"})," and setting it explicitly:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-csharp",children:"protected override void OnModelCreating(ModelBuilder modelBuilder)\n{\n    var converter = new BoolToZeroOneConverter<int>();\n\n    modelBuilder\n        .Entity<User>()\n        .Property(e => e.IsActive)\n        .HasConversion(converter);\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["A list of the built-in converters can be found in the ",(0,o.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/ef/core/modeling/value-conversions?tabs=fluent-api#built-in-converters",children:"Microsoft Docs"}),"."]})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>a});var t=r(96540);const o={},i=t.createContext(o);function s(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);