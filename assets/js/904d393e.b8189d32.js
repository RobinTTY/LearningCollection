"use strict";(self.webpackChunklearning_knowledge_base=self.webpackChunklearning_knowledge_base||[]).push([[8864],{36093:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>h,frontMatter:()=>r,metadata:()=>l,toc:()=>o});const l=JSON.parse('{"id":"cloud/aws/certified-developer-associate/elb","title":"Elastic Load Balancing (ELB)","description":"Scalability & High Availability","source":"@site/docs/cloud/aws/certified-developer-associate/elb.md","sourceDirName":"cloud/aws/certified-developer-associate","slug":"/cloud/aws/certified-developer-associate/elb","permalink":"/LearningCollection/cloud/aws/certified-developer-associate/elb","draft":false,"unlisted":false,"editUrl":"https://github.com/RobinTTY/LearningCollection/tree/master/website/docs/cloud/aws/certified-developer-associate/elb.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"Elastic Load Balancing (ELB)","sidebar_position":4},"sidebar":"docs","previous":{"title":"Elastic Compute Cloud (EC2)","permalink":"/LearningCollection/cloud/aws/certified-developer-associate/ec2"},"next":{"title":"Relational Databases (RDS/Aurora)","permalink":"/LearningCollection/cloud/aws/certified-developer-associate/relational-databases"}}');var s=i(74848),a=i(28453);const r={title:"Elastic Load Balancing (ELB)",sidebar_position:4},t=void 0,c={},o=[{value:"Scalability &amp; High Availability",id:"scalability--high-availability",level:2},{value:"Examples",id:"examples",level:3},{value:"Load Balancing",id:"load-balancing",level:2},{value:"Why use a load balancer?",id:"why-use-a-load-balancer",level:3},{value:"Why use an Elastic Load Balancer?",id:"why-use-an-elastic-load-balancer",level:3},{value:"Health Checks",id:"health-checks",level:3},{value:"Types of load balancer on AWS",id:"types-of-load-balancer-on-aws",level:3},{value:"Security Groups",id:"security-groups",level:3},{value:"CLB - Classic Load Balancers (v1)",id:"clb---classic-load-balancers-v1",level:3},{value:"ALB - Application Load Balancer (v2)",id:"alb---application-load-balancer-v2",level:3},{value:"HTTP Based Traffic",id:"http-based-traffic",level:4},{value:"Possible Target Groups",id:"possible-target-groups",level:4},{value:"Query Strings/Parameters Routing",id:"query-stringsparameters-routing",level:4},{value:"Good to Know",id:"good-to-know",level:4},{value:"NLB - Network Load Balancer (v2)",id:"nlb---network-load-balancer-v2",level:3},{value:"TCP (Layer 4) Based Traffic",id:"tcp-layer-4-based-traffic",level:4},{value:"Possible Target Groups",id:"possible-target-groups-1",level:4},{value:"GLB - Gateway Load Balancer",id:"glb---gateway-load-balancer",level:3},{value:"Possible Target Groups",id:"possible-target-groups-2",level:4},{value:"Sticky Sessions (Session Affinity)",id:"sticky-sessions-session-affinity",level:3},{value:"Cookie Names",id:"cookie-names",level:4},{value:"Cross-Zone Load Balancing",id:"cross-zone-load-balancing",level:3},{value:"SSL Certificates",id:"ssl-certificates",level:3},{value:"Server Name Indication (SNI)",id:"server-name-indication-sni",level:4},{value:"SSL Certs by Load Balancer",id:"ssl-certs-by-load-balancer",level:3},{value:"Connection Draining",id:"connection-draining",level:3},{value:"Auto Scaling Groups",id:"auto-scaling-groups",level:2},{value:"Attributes",id:"attributes",level:3},{value:"CloudWatch Alarms &amp; Scaling",id:"cloudwatch-alarms--scaling",level:3},{value:"Scaling Policies",id:"scaling-policies",level:3},{value:"Good metrics to scale on",id:"good-metrics-to-scale-on",level:3},{value:"Scaling Cooldowns",id:"scaling-cooldowns",level:3},{value:"Instance Refresh",id:"instance-refresh",level:3}];function d(e){const n={a:"a",admonition:"admonition",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"scalability--high-availability",children:"Scalability & High Availability"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["There are two kinds of scalability","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Vertical Scalability (increasing the size of the instance)"}),"\n",(0,s.jsx)(n.li,{children:"Horizontal Scalability or Elasticity (increasing the number of instances / systems for your application)"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"Scalability is linked but different to High Availability"}),"\n",(0,s.jsxs)(n.li,{children:["High Availability usually goes hand in hand with horizontal scaling","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"High availability means running your application / system in at least 2 data centers (== Availability Zones)"}),"\n",(0,s.jsx)(n.li,{children:"The goal of high availability is to survive a data center loss"}),"\n",(0,s.jsx)(n.li,{children:"The high availability can be passive (for RDS Multi AZ for example)"}),"\n",(0,s.jsx)(n.li,{children:"The high availability can be active (for horizontal scaling)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"examples",children:"Examples"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Vertical Scaling: Increase instance size (= scale up / down)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"From: t2.nano - 0.5G of RAM, 1 vCPU"}),"\n",(0,s.jsx)(n.li,{children:"To: u-12tb1.metal \u2013 12.3 TB of RAM, 448 vCPUs"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Horizontal Scaling: Increase number of instances (= scale out / in)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Auto Scaling Group"}),"\n",(0,s.jsx)(n.li,{children:"Load Balancer"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["High Availability: Run instances for the same application across multi AZ","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Auto Scaling Group multi AZ"}),"\n",(0,s.jsx)(n.li,{children:"Load Balancer multi AZ"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"load-balancing",children:"Load Balancing"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Load Balances are servers that forward traffic to multiple servers (e.g., EC2 instances) downstream"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"load-balancer",src:i(74706).A+"",width:"1362",height:"583"})}),"\n",(0,s.jsx)(n.h3,{id:"why-use-a-load-balancer",children:"Why use a load balancer?"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Spread load across multiple downstream instances"}),"\n",(0,s.jsx)(n.li,{children:"Expose a single point of access (DNS) to your application"}),"\n",(0,s.jsx)(n.li,{children:"Seamlessly handle failures of downstream instances"}),"\n",(0,s.jsx)(n.li,{children:"Do regular health checks to your instances"}),"\n",(0,s.jsx)(n.li,{children:"Provide SSL termination (HTTPS) for your websites"}),"\n",(0,s.jsx)(n.li,{children:"Enforce stickiness with cookies"}),"\n",(0,s.jsx)(n.li,{children:"High availability across zones"}),"\n",(0,s.jsx)(n.li,{children:"Separate public traffic from private traffic"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"why-use-an-elastic-load-balancer",children:"Why use an Elastic Load Balancer?"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["An Elastic Load Balancer is a managed load balancer","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"AWS guarantees that it will be working"}),"\n",(0,s.jsx)(n.li,{children:"AWS takes care of upgrades, maintenance, high availability"}),"\n",(0,s.jsx)(n.li,{children:"AWS provides only a few configuration knobs"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"It costs less to setup your own load balancer but it will be a lot more effort on your end"}),"\n",(0,s.jsxs)(n.li,{children:["It is integrated with many AWS offerings / services","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"EC2, EC2 Auto Scaling Groups, Amazon ECS"}),"\n",(0,s.jsx)(n.li,{children:"AWS Certificate Manager (ACM), CloudWatch"}),"\n",(0,s.jsx)(n.li,{children:"Route 53, AWS WAF, AWS Global Accelerator"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"health-checks",children:"Health Checks"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Health Checks are crucial for Load Balancers"}),"\n",(0,s.jsx)(n.li,{children:"They enable the load balancer to know if instances it forwards traffic to are available to reply to requests"}),"\n",(0,s.jsx)(n.li,{children:"The health check is done on a port and a route (/health is common)"}),"\n",(0,s.jsx)(n.li,{children:"If the response is not 200 (OK), then the instance is unhealthy"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"health-checks",src:i(27697).A+"",width:"712",height:"193"})}),"\n",(0,s.jsx)(n.h3,{id:"types-of-load-balancer-on-aws",children:"Types of load balancer on AWS"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Classic Load Balancer (v1)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"HTTP, HTTPS, TCP, SSL (secure TCP)"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Application Load Balancer (v2)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"HTTP, HTTPS, WebSocket"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Network Load Balancer (v2)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"TCP, TLS (secure TCP), UDP"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Gateway Load Balancer (GWLB - newest type of balancer)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Operates at layer 3 (Network layer) \u2013 IP Protocol"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Overall, it is recommended to use the newer generation load balancers as they provide more features"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Some load balancers can be setup as internal (private) or external (public) ELBs"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"security-groups",children:"Security Groups"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:i(36746).A+"",children:"load-balancer-security-groups"})}),"\n",(0,s.jsx)(n.h3,{id:"clb---classic-load-balancers-v1",children:"CLB - Classic Load Balancers (v1)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Supports TCP (Layer 4), HTTP & HTTPS (Layer 7)"}),"\n",(0,s.jsx)(n.li,{children:"Health checks are TCP or HTTP based"}),"\n",(0,s.jsx)(n.li,{children:"Fixed hostname XXX.region.elb.amazonaws.com"}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:"Most likely not relevant anymore for exam since its deprecated."})}),"\n",(0,s.jsx)(n.h3,{id:"alb---application-load-balancer-v2",children:"ALB - Application Load Balancer (v2)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Application load balancers is Layer 7 (HTTP)"}),"\n",(0,s.jsx)(n.li,{children:"Load balancing to multiple HTTP applications across machines (target groups)"}),"\n",(0,s.jsx)(n.li,{children:"Load balancing to multiple applications on the same machine (ex: containers)"}),"\n",(0,s.jsx)(n.li,{children:"Support for HTTP/2 and WebSocket"}),"\n",(0,s.jsx)(n.li,{children:"Supports redirects (from HTTP to HTTPS for example)"}),"\n",(0,s.jsxs)(n.li,{children:["Routing tables to different target groups:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Routing based on path in URL (example.com/users & example.com/posts)"}),"\n",(0,s.jsx)(n.li,{children:"Routing based on hostname in URL (one.example.com & other.example.com)"}),"\n",(0,s.jsx)(n.li,{children:"Routing based on Query String, Headers (example.com/users?id=123&order=false)"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"ALB are a great fit for micro services & container-based application (example: Docker & Amazon ECS)"}),"\n",(0,s.jsx)(n.li,{children:"Has a port mapping feature to redirect to a dynamic port in ECS"}),"\n",(0,s.jsx)(n.li,{children:"In comparison, we\u2019d need multiple Classic Load Balancer per application"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"http-based-traffic",children:"HTTP Based Traffic"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"alb",src:i(64174).A+"",width:"1114",height:"477"})}),"\n",(0,s.jsx)(n.h4,{id:"possible-target-groups",children:"Possible Target Groups"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"EC2 instances (can be managed by an Auto Scaling Group) \u2013 HTTP"}),"\n",(0,s.jsx)(n.li,{children:"ECS tasks (managed by ECS itself) \u2013 HTTP"}),"\n",(0,s.jsx)(n.li,{children:"Lambda functions \u2013 HTTP request is translated into a JSON event"}),"\n",(0,s.jsx)(n.li,{children:"IP Addresses \u2013 must be private IPs"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"ALB can route to multiple target groups. Health checks are at the target group level."}),"\n",(0,s.jsx)(n.h4,{id:"query-stringsparameters-routing",children:"Query Strings/Parameters Routing"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"query-string-routing",src:i(31354).A+"",width:"1107",height:"463"})}),"\n",(0,s.jsx)(n.h4,{id:"good-to-know",children:"Good to Know"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Fixed hostname (XXX.region.elb.amazonaws.com)"}),"\n",(0,s.jsxs)(n.li,{children:["The application servers don\u2019t see the IP of the client directly","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"The true IP of the client is inserted in the header X-Forwarded-For"}),"\n",(0,s.jsx)(n.li,{children:"We can also get Port (X-Forwarded-Port) and proto (X-Forwarded-Proto)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"nlb---network-load-balancer-v2",children:"NLB - Network Load Balancer (v2)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Network load balancers (Layer 4) allow to:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Forward TCP & UDP traffic to your instances"}),"\n",(0,s.jsx)(n.li,{children:"Handle millions of request per seconds"}),"\n",(0,s.jsx)(n.li,{children:"Ultra-low latency"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"NLB has one static IP per AZ, and supports assigning Elastic IP (helpful for whitelisting specific IP)"}),"\n",(0,s.jsx)(n.li,{children:"NLB are used for extreme performance, TCP or UDP traffic"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"tcp-layer-4-based-traffic",children:"TCP (Layer 4) Based Traffic"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"nlb-tcp",src:i(62703).A+"",width:"1122",height:"465"})}),"\n",(0,s.jsx)(n.h4,{id:"possible-target-groups-1",children:"Possible Target Groups"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"EC2 instances"}),"\n",(0,s.jsx)(n.li,{children:"IP Addresses \u2013 must be private IPs"}),"\n",(0,s.jsx)(n.li,{children:"Application Load Balancer"}),"\n",(0,s.jsx)(n.li,{children:"Health Checks support the TCP, HTTP and HTTPS Protocols"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"nlb-target-group",src:i(12365).A+"",width:"1054",height:"313"})}),"\n",(0,s.jsx)(n.h3,{id:"glb---gateway-load-balancer",children:"GLB - Gateway Load Balancer"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Deploy, scale, and manage a fleet of 3rd party network virtual appliances in AWS","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Example: Firewalls, Intrusion Detection and Prevention Systems, Deep Packet Inspection Systems, payload manipulation, etc."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"Operates at Layer 3 (Network Layer) \u2013 IP Packets"}),"\n",(0,s.jsxs)(n.li,{children:["Combines the following functions:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Transparent Network Gateway \u2013 single entry/exit for all traffic"}),"\n",(0,s.jsx)(n.li,{children:"Load Balancer \u2013 distributes traffic to your virtual appliances"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Uses the ",(0,s.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Generic_Network_Virtualization_Encapsulation",children:"GENEVE protocol"})," on port 6081"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"glb",src:i(53848).A+"",width:"373",height:"646"})}),"\n",(0,s.jsx)(n.h4,{id:"possible-target-groups-2",children:"Possible Target Groups"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"EC2 instances"}),"\n",(0,s.jsx)(n.li,{children:"IP Addresses \u2013 must be private IPs"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"glb-target-groups",src:i(79395).A+"",width:"862",height:"333"})}),"\n",(0,s.jsx)(n.h3,{id:"sticky-sessions-session-affinity",children:"Sticky Sessions (Session Affinity)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Goal: Same client is always redirected to the same instance behind a load balancer"}),"\n",(0,s.jsxs)(n.li,{children:["This works for Classic Load Balancer, Application Load Balancer, and Network Load Balancer","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"For both CLB & ALB, the \u201ccookie\u201d used for stickiness has an expiration date you control"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"Use case: make sure the user doesn\u2019t lose his session data"}),"\n",(0,s.jsx)(n.li,{children:"Enabling stickiness may bring imbalance to the load over the backend EC2 instances"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"cookie-names",children:"Cookie Names"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Application-based Cookies","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Custom cookie","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Generated by the target"}),"\n",(0,s.jsx)(n.li,{children:"Can include any custom attributes required by the application"}),"\n",(0,s.jsx)(n.li,{children:"Cookie name must be specified individually for each target group"}),"\n",(0,s.jsx)(n.li,{children:"Don\u2019t use AWSALB, AWSALBAPP, or AWSALBTG (reserved for use by the ELB)"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Application cookie","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Generated by the load balancer"}),"\n",(0,s.jsx)(n.li,{children:"Cookie name is AWSALBAPP"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Duration-based Cookies","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Cookie generated by the load balancer"}),"\n",(0,s.jsx)(n.li,{children:"Cookie name is AWSALB for ALB, AWSELB for CLB"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:"For exam it is only important to know high level that there are different cookies which are either application-based or duration-based."})}),"\n",(0,s.jsx)(n.h3,{id:"cross-zone-load-balancing",children:"Cross-Zone Load Balancing"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"cross-zone-load-balancer",src:i(37726).A+"",width:"1092",height:"477"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Application Load Balancer","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Enabled by default (can be disabled at the Target Group level)"}),"\n",(0,s.jsx)(n.li,{children:"No charges for inter AZ data"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Network Load Balancer & Gateway Load Balancer","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Disabled by default"}),"\n",(0,s.jsx)(n.li,{children:"You pay charges ($) for inter AZ data if enabled"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Classic Load Balancer","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Disabled by default"}),"\n",(0,s.jsx)(n.li,{children:"No charges for inter AZ data if enabled"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"ssl-certificates",children:"SSL Certificates"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"lb-ssl",src:i(33114).A+"",width:"907",height:"153"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"The load balancer uses an X.509 certificate (SSL/TLS server certificate)"}),"\n",(0,s.jsx)(n.li,{children:"You can manage cer tificates using ACM (AWS Certificate Manager)"}),"\n",(0,s.jsx)(n.li,{children:"You can create upload your own certificates alternatively"}),"\n",(0,s.jsxs)(n.li,{children:["HTTPS listener:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"You must specify a default cer tificate"}),"\n",(0,s.jsx)(n.li,{children:"You can add an optional list of cer ts to suppor t multiple domains"}),"\n",(0,s.jsx)(n.li,{children:"Clients can use SNI (Server Name Indication) to specify the hostname they reach"}),"\n",(0,s.jsx)(n.li,{children:"Ability to specify a security policy to support older versions of SSL / TLS (legacy clients)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"server-name-indication-sni",children:"Server Name Indication (SNI)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["SNI solves the problem of loading multiple SSL certificates onto one web server (to serve multiple websites)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Only works for ALB & NLB (newer generation), CloudFront"}),"\n",(0,s.jsx)(n.li,{children:"Does not work for CLB (older gen)"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"It\u2019s a \u201cnewer\u201d protocol, and requires the client to indicate the hostname of the target server in the initial SSL handshake"}),"\n",(0,s.jsx)(n.li,{children:"The server will then find the correct certificate, or return the default one"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"server-name-indication",src:i(26159).A+"",width:"526",height:"484"})}),"\n",(0,s.jsx)(n.h3,{id:"ssl-certs-by-load-balancer",children:"SSL Certs by Load Balancer"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Classic Load Balancer (v1)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Support only one SSL certificate"}),"\n",(0,s.jsx)(n.li,{children:"Must use multiple CLB for multiple hostname with multiple SSL certificates"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Application Load Balancer (v2)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Supports multiple listeners with multiple SSL certificates"}),"\n",(0,s.jsx)(n.li,{children:"Uses Server Name Indication (SNI) to make it work"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Network Load Balancer (v2)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Supports multiple listeners with multiple SSL certificates"}),"\n",(0,s.jsx)(n.li,{children:"Uses Server Name Indication (SNI) to make it work"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"connection-draining",children:"Connection Draining"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Feature is named Connection Draining for CLB or Deregistration Delay \u2013 for ALB & NLB"}),"\n",(0,s.jsx)(n.li,{children:"Time to complete \u201cin-flight requests\u201d while the instance is de-registering or unhealthy"}),"\n",(0,s.jsx)(n.li,{children:"Stops sending new requests to the EC2 instance which is de-registering"}),"\n",(0,s.jsxs)(n.li,{children:["Between 1 to 3600 seconds (default: 300 seconds)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Can be disabled (set value to 0)"}),"\n",(0,s.jsx)(n.li,{children:"Set to a low value if your requests are short"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"connection-draining",src:i(81442).A+"",width:"483",height:"403"})}),"\n",(0,s.jsx)(n.h2,{id:"auto-scaling-groups",children:"Auto Scaling Groups"}),"\n",(0,s.jsx)(n.p,{children:"The goal of an Auto Scaling Group (ASG) is to:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Scale out (add EC2 instances) to match an increased load"}),"\n",(0,s.jsx)(n.li,{children:"Scale in (remove EC2 instances) to match a decreased load"}),"\n",(0,s.jsx)(n.li,{children:"Ensure we have a minimum and a maximum number of EC2 instances running"}),"\n",(0,s.jsx)(n.li,{children:"Automatically register new instances to a load balancer"}),"\n",(0,s.jsx)(n.li,{children:"Re-create an EC2 instance in case a previous one is terminated (ex: if unhealthy)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"ASG are free (you only pay for the underlying EC2 instances)."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"auto-scaling-groups",src:i(21355).A+"",width:"1015",height:"460"})}),"\n",(0,s.jsx)(n.p,{children:"Auto Scaling Group with Load Balancer:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"auto-scaling-load-balancer",src:i(1928).A+"",width:"985",height:"493"})}),"\n",(0,s.jsx)(n.h3,{id:"attributes",children:"Attributes"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["A Launch Template","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"AMI + Instance Type"}),"\n",(0,s.jsx)(n.li,{children:"EC2 User Data"}),"\n",(0,s.jsx)(n.li,{children:"EBS Volumes"}),"\n",(0,s.jsx)(n.li,{children:"Security Groups"}),"\n",(0,s.jsx)(n.li,{children:"SSH Key Pair"}),"\n",(0,s.jsx)(n.li,{children:"IAM Roles for your EC2 Instances"}),"\n",(0,s.jsx)(n.li,{children:"Network + Subnets Information"}),"\n",(0,s.jsx)(n.li,{children:"Load Balancer Information"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"Min Size / Max Size / Initial Capacity"}),"\n",(0,s.jsx)(n.li,{children:"Scaling Policies"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"asg-attributes",src:i(36374).A+"",width:"412",height:"436"})}),"\n",(0,s.jsx)(n.h3,{id:"cloudwatch-alarms--scaling",children:"CloudWatch Alarms & Scaling"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"It is possible to scale an ASG based on CloudWatch alarms"}),"\n",(0,s.jsx)(n.li,{children:"An alarm monitors a metric (such as Average CPU, or a custom metric)"}),"\n",(0,s.jsx)(n.li,{children:"Metrics such as Average CPU are computed for the overall ASG instances"}),"\n",(0,s.jsxs)(n.li,{children:["Based on the alarm:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"We can create scale-out policies (increase the number of instances)"}),"\n",(0,s.jsx)(n.li,{children:"We can create scale-in policies (decrease the number of instances)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"as-alarms-scaling",src:i(73630).A+"",width:"994",height:"192"})}),"\n",(0,s.jsx)(n.h3,{id:"scaling-policies",children:"Scaling Policies"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Dynamic Scaling","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Target Tracking Scaling","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Simple to set-up"}),"\n",(0,s.jsx)(n.li,{children:"Example: I want the average ASG CPU to stay at around 40%"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Simple / Step Scaling","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"When a CloudWatch alarm is triggered (example CPU > 70%), then add 2 units"}),"\n",(0,s.jsx)(n.li,{children:"When a CloudWatch alarm is triggered (example CPU < 30%), then remove 1"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Scheduled Scaling","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Anticipate a scaling based on known usage patterns"}),"\n",(0,s.jsx)(n.li,{children:"Example: increase the min capacity to 10 at 5 pm on Fridays"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"Predictive scaling: continuously forecast load and schedule scaling ahead"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"predictive-scaling",src:i(89478).A+"",width:"901",height:"298"})}),"\n",(0,s.jsx)(n.h3,{id:"good-metrics-to-scale-on",children:"Good metrics to scale on"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"CPUUtilization: Average CPU utilization across your instances"}),"\n",(0,s.jsx)(n.li,{children:"RequestCountPerTarget: to make sure the number of requests per EC2 instances is stable"}),"\n",(0,s.jsx)(n.li,{children:"Average Network In / Out (if you\u2019re application is network bound)"}),"\n",(0,s.jsx)(n.li,{children:"Any custom metric (that you push using CloudWatch)"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"scaling-cooldowns",children:"Scaling Cooldowns"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"After a scaling activity happens, you are in the cooldown period (default 300 seconds)"}),"\n",(0,s.jsx)(n.li,{children:"During the cooldown period, the ASG will not launch or terminate additional instances (to allow for metrics to stabilize)"}),"\n",(0,s.jsx)(n.li,{children:"Advice: Use a ready-to-use AMI to reduce configuration time in order to be serving request faster and reduce the cooldown period"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"instance-refresh",children:"Instance Refresh"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Goal: update all EC2 instances based on new launch template"}),"\n",(0,s.jsx)(n.li,{children:"Setting of minimum healthy percentage (percentage which will remain up during refresh)"}),"\n",(0,s.jsx)(n.li,{children:"Specify warm-up time (how long until the instance is ready to use)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"instance-refresh",src:i(56818).A+"",width:"540",height:"556"})})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},36746:(e,n,i)=>{i.d(n,{A:()=>l});const l=i.p+"assets/files/load-balancer-security-groups-e3e6fc0b09c49d16db49ccfbe045224b.png"},64174:(e,n,i)=>{i.d(n,{A:()=>l});const l=i.p+"assets/images/alb-21f2b7a956c4527e70d5237b6a05a179.png"},73630:(e,n,i)=>{i.d(n,{A:()=>l});const l=i.p+"assets/images/as-alarms-scaling-80ee8e79d643e6d7192675348bb56907.png"},36374:(e,n,i)=>{i.d(n,{A:()=>l});const l=i.p+"assets/images/asg-attributes-6cddbc5ca555f76acfd5436ae2090003.png"},21355:(e,n,i)=>{i.d(n,{A:()=>l});const l=i.p+"assets/images/auto-scaling-groups-f4ad1ded3834f68643652ceee711df6c.png"},1928:(e,n,i)=>{i.d(n,{A:()=>l});const l=i.p+"assets/images/auto-scaling-load-balancer-e21c5348e8e57c31e23100bd9015a176.png"},81442:(e,n,i)=>{i.d(n,{A:()=>l});const l=i.p+"assets/images/connection-draining-13c5f8381539f1a6090b11cc3b005355.png"},37726:(e,n,i)=>{i.d(n,{A:()=>l});const l=i.p+"assets/images/cross-zone-load-balancer-342effccba483b02c6b067af9e4a8b81.png"},79395:(e,n,i)=>{i.d(n,{A:()=>l});const l=i.p+"assets/images/glb-target-groups-e2104b8eb000777ebb7a220b43ff691c.png"},53848:(e,n,i)=>{i.d(n,{A:()=>l});const l=i.p+"assets/images/glb-bde2a68ab670b881494392f51588bb3c.png"},27697:(e,n,i)=>{i.d(n,{A:()=>l});const l=i.p+"assets/images/health-checks-2f86204d9134daaa94f3814eec99341e.png"},56818:(e,n,i)=>{i.d(n,{A:()=>l});const l=i.p+"assets/images/instance-refresh-f1ffdc43117e18ed598aee75188cfdfb.png"},33114:(e,n,i)=>{i.d(n,{A:()=>l});const l=i.p+"assets/images/lb-ssl-7b29776248dae905a9932672d8f3da0d.png"},74706:(e,n,i)=>{i.d(n,{A:()=>l});const l=i.p+"assets/images/load-balancer-a36427e3437aa343c6a47e52b8c1e543.png"},12365:(e,n,i)=>{i.d(n,{A:()=>l});const l=i.p+"assets/images/nlb-target-group-816d82aad909a7bc65d20bc8f19b64ab.png"},62703:(e,n,i)=>{i.d(n,{A:()=>l});const l=i.p+"assets/images/nlb-tcp-abd10081fd60f7e8efd9637405f034ea.png"},89478:(e,n,i)=>{i.d(n,{A:()=>l});const l=i.p+"assets/images/predictive-scaling-f9381dd064c53cad1a8e6a74bb093bfb.png"},31354:(e,n,i)=>{i.d(n,{A:()=>l});const l=i.p+"assets/images/query-string-routing-9bac6fa09f699a08817426249db4299b.png"},26159:(e,n,i)=>{i.d(n,{A:()=>l});const l=i.p+"assets/images/server-name-indication-148a22f6c16903cf1444bc5c34e89e4e.png"},28453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>t});var l=i(96540);const s={},a=l.createContext(s);function r(e){const n=l.useContext(a);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),l.createElement(a.Provider,{value:n},e.children)}}}]);