"use strict";(self.webpackChunklearning_knowledge_base=self.webpackChunklearning_knowledge_base||[]).push([[4522],{50951:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>t,metadata:()=>l,toc:()=>o});var i=s(74848),r=s(28453);const t={title:"Security & Encryption",sidebar_position:26},a=void 0,l={id:"cloud/aws/certified-developer-associate/security-encryption",title:"Security & Encryption",description:"AWS KMS (Key Management Service)",source:"@site/docs/cloud/aws/certified-developer-associate/security-encryption.md",sourceDirName:"cloud/aws/certified-developer-associate",slug:"/cloud/aws/certified-developer-associate/security-encryption",permalink:"/LearningCollection/cloud/aws/certified-developer-associate/security-encryption",draft:!1,unlisted:!1,editUrl:"https://github.com/RobinTTY/LearningCollection/tree/master/website/docs/cloud/aws/certified-developer-associate/security-encryption.md",tags:[],version:"current",sidebarPosition:26,frontMatter:{title:"Security & Encryption",sidebar_position:26},sidebar:"docs",previous:{title:"Advanced Identity",permalink:"/LearningCollection/cloud/aws/certified-developer-associate/advanced-identity"},next:{title:"Other Services",permalink:"/LearningCollection/cloud/aws/certified-developer-associate/other-services"}},c={},o=[{value:"AWS KMS (Key Management Service)",id:"aws-kms-key-management-service",level:2},{value:"KMS Keys Types",id:"kms-keys-types",level:3},{value:"Copying Snapshots across regions",id:"copying-snapshots-across-regions",level:3},{value:"KMS Key Policies",id:"kms-key-policies",level:3},{value:"Copying Snapshots across accounts",id:"copying-snapshots-across-accounts",level:3},{value:"KMS API - Encrypt and Decrypt",id:"kms-api---encrypt-and-decrypt",level:3},{value:"Envelope Encryption",id:"envelope-encryption",level:3},{value:"GenerateDataKey API",id:"generatedatakey-api",level:4},{value:"Decrypt envelope data",id:"decrypt-envelope-data",level:4},{value:"Encryption SDK",id:"encryption-sdk",level:3},{value:"KMS Symmetric \u2013 API Summary",id:"kms-symmetric--api-summary",level:3},{value:"KMS Request Quotas",id:"kms-request-quotas",level:3},{value:"S3 Bucket Key for SSE-KMS encryption",id:"s3-bucket-key-for-sse-kms-encryption",level:3},{value:"Key Policy \u2013 Examples",id:"key-policy--examples",level:3},{value:"Principal Options in IAM Policies",id:"principal-options-in-iam-policies",level:3},{value:"CloudHSM",id:"cloudhsm",level:2},{value:"High Availability",id:"high-availability",level:3},{value:"Integration with AWS Services",id:"integration-with-aws-services",level:3},{value:"CloudHSM vs. KMS",id:"cloudhsm-vs-kms",level:3},{value:"SSM Parameter Store",id:"ssm-parameter-store",level:2},{value:"Hierarchy",id:"hierarchy",level:3},{value:"Standard and advanced parameter tiers",id:"standard-and-advanced-parameter-tiers",level:3},{value:"Parameters Policies (for advanced parameters)",id:"parameters-policies-for-advanced-parameters",level:3},{value:"AWS Secrets Manager",id:"aws-secrets-manager",level:2},{value:"Multi-Region Secrets",id:"multi-region-secrets",level:3},{value:"SSM Parameter Store vs Secrets Manager",id:"ssm-parameter-store-vs-secrets-manager",level:2},{value:"Rotation",id:"rotation",level:3},{value:"CloudFormation \u2013 Dynamic References",id:"cloudformation--dynamic-references",level:2},{value:"Option 1 \u2013 ManageMasterUserPassword",id:"option-1--managemasteruserpassword",level:3},{value:"Option 2 \u2013 Dynamic Reference",id:"option-2--dynamic-reference",level:3},{value:"CloudWatch Logs - Encryption",id:"cloudwatch-logs---encryption",level:2},{value:"CodeBuild Security",id:"codebuild-security",level:2},{value:"AWS Nitro Enclaves",id:"aws-nitro-enclaves",level:2}];function d(e){const n={h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"aws-kms-key-management-service",children:"AWS KMS (Key Management Service)"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Anytime you hear \u201cencryption\u201d for an AWS service, it\u2019s most likely KMS"}),"\n",(0,i.jsx)(n.li,{children:"AWS manages encryption keys for us"}),"\n",(0,i.jsx)(n.li,{children:"Fully integrated with IAM for authorization"}),"\n",(0,i.jsx)(n.li,{children:"Easy way to control access to your data"}),"\n",(0,i.jsx)(n.li,{children:"Able to audit KMS Key usage using CloudTrail"}),"\n",(0,i.jsx)(n.li,{children:"Seamlessly integrated into most AWS services (EBS, S3, RDS, SSM\u2026)"}),"\n",(0,i.jsxs)(n.li,{children:["Never ever store your secrets in plaintext, especially in your code!","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"KMS Key Encryption also available through API calls (SDK, CLI)"}),"\n",(0,i.jsx)(n.li,{children:"Encrypted secrets can be stored in the code / environment variables"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"kms-keys-types",children:"KMS Keys Types"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"KMS Keys is the new name of KMS Customer Master Key"}),"\n",(0,i.jsxs)(n.li,{children:["Symmetric (AES-256 keys)","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Single encryption key that is used to Encrypt and Decrypt"}),"\n",(0,i.jsx)(n.li,{children:"AWS services that are integrated with KMS use Symmetric CMKs"}),"\n",(0,i.jsx)(n.li,{children:"You never get access to the KMS Key unencr ypted (must call KMS API to use)"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Asymmetric (RSA & ECC key pairs)","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Public (Encrypt) and Private Key (Decrypt) pair"}),"\n",(0,i.jsx)(n.li,{children:"Used for Encrypt/Decrypt, or Sign/Verify operations"}),"\n",(0,i.jsx)(n.li,{children:"The public key is downloadable, but you can\u2019t access the Private Key unencrypted"}),"\n",(0,i.jsx)(n.li,{children:"Use case: encryption outside of AWS by users who can\u2019t call the KMS API"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Types of KMS Keys:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"AWS Owned Keys (free): SSE-S3, SSE-SQS, SSE-DDB (default key)"}),"\n",(0,i.jsx)(n.li,{children:"AWS Managed Key: free (aws/service-name, example: aws/rds or aws/ebs)"}),"\n",(0,i.jsx)(n.li,{children:"Customer managed keys created in KMS: $1 / month"}),"\n",(0,i.jsx)(n.li,{children:"Customer managed keys imported: $1 / month"}),"\n",(0,i.jsx)(n.li,{children:"pay for API call to KMS ($0.03 / 10000 calls)"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Automatic Key rotation:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"AWS-managed KMS Key: automatic every 1 year"}),"\n",(0,i.jsx)(n.li,{children:"Customer-managed KMS Key: (must be enabled) automatic & on-demand"}),"\n",(0,i.jsx)(n.li,{children:"Imported KMS Key: only manual rotation possible using alias"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"copying-snapshots-across-regions",children:"Copying Snapshots across regions"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"kms-copying-snapshots",src:s(94008).A+"",width:"618",height:"264"})}),"\n",(0,i.jsx)(n.h3,{id:"kms-key-policies",children:"KMS Key Policies"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Control access to KMS keys, \u201csimilar\u201d to S3 bucket policies"}),"\n",(0,i.jsx)(n.li,{children:"Difference: you cannot control access without them"}),"\n",(0,i.jsxs)(n.li,{children:["Default KMS Key Policy:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Created if you don\u2019t provide a specific KMS Key Policy"}),"\n",(0,i.jsx)(n.li,{children:"Complete access to the key to the root user = entire AWS account"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Custom KMS Key Policy:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Define users, roles that can access the KMS key"}),"\n",(0,i.jsx)(n.li,{children:"Define who can administer the key"}),"\n",(0,i.jsx)(n.li,{children:"Useful for cross-account access of your KMS key"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"copying-snapshots-across-accounts",children:"Copying Snapshots across accounts"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Create a Snapshot, encrypted with your own KMS Key (Customer Managed Key)"}),"\n",(0,i.jsx)(n.li,{children:"Attach a KMS Key Policy to authorize cross-account access"}),"\n",(0,i.jsx)(n.li,{children:"Share the encrypted snapshot"}),"\n",(0,i.jsx)(n.li,{children:"(in target) Create a copy of the Snapshot, encrypt it with a CMK in your account"}),"\n",(0,i.jsx)(n.li,{children:"Create a volume from the snapshot"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"kms-api---encrypt-and-decrypt",children:"KMS API - Encrypt and Decrypt"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"kms-encrypt-decrypt",src:s(55726).A+"",width:"610",height:"265"})}),"\n",(0,i.jsx)(n.h3,{id:"envelope-encryption",children:"Envelope Encryption"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"KMS Encrypt API call has a limit of 4 KB"}),"\n",(0,i.jsx)(n.li,{children:"If you want to encrypt >4 KB, we need to use Envelope Encryption"}),"\n",(0,i.jsx)(n.li,{children:"The main API that will help us is the GenerateDataKey API"}),"\n",(0,i.jsx)(n.li,{children:"For the exam: anything over 4 KB of data that needs to be encrypted must use the Envelope Encryption == GenerateDataKey API"}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"generatedatakey-api",children:"GenerateDataKey API"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"envelope-encryption",src:s(59623).A+"",width:"647",height:"253"})}),"\n",(0,i.jsx)(n.h4,{id:"decrypt-envelope-data",children:"Decrypt envelope data"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"decrypt-envelope-data",src:s(52640).A+"",width:"649",height:"275"})}),"\n",(0,i.jsx)(n.h3,{id:"encryption-sdk",children:"Encryption SDK"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"The AWS Encryption SDK implemented Envelope Encryption for us"}),"\n",(0,i.jsx)(n.li,{children:"The Encryption SDK also exists as a CLI tool we can install"}),"\n",(0,i.jsx)(n.li,{children:"Implementations for Java, Python, C, JavaScript"}),"\n",(0,i.jsxs)(n.li,{children:["Feature - Data Key Caching:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"re-use data keys instead of creating new ones for each encryption"}),"\n",(0,i.jsx)(n.li,{children:"Helps with reducing the number of calls to KMS with a security trade-off"}),"\n",(0,i.jsx)(n.li,{children:"Use LocalCryptoMaterialsCache (max age, max bytes, max number of messages)"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"The SDK encrypts the data encryption key and stores it (encrypted) as part of the returned ciphertext."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"kms-symmetric--api-summary",children:"KMS Symmetric \u2013 API Summary"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Encrypt:"})," encrypt up to 4 KB of data through KMS"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"GenerateDataKey:"})," generates a unique symmetric data key (DEK)","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"returns a plaintext copy of the data key"}),"\n",(0,i.jsx)(n.li,{children:"AND a copy that is encrypted under the CMK that you specify"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"GenerateDataKeyWithoutPlaintext:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Generate a DEK to use at some point (not immediately)"}),"\n",(0,i.jsx)(n.li,{children:"DEK that is encrypted under the CMK that you specify (must use Decrypt later)"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Decrypt:"})," decrypt up to 4 KB of data (including Data Encryption Keys)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"GenerateRandom:"})," Returns a random byte string"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"kms-request-quotas",children:"KMS Request Quotas"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"When you exceed a request quota, you get a ThrottlingException"}),"\n",(0,i.jsx)(n.li,{children:"To respond, use exponential backoff (backoff and retry)"}),"\n",(0,i.jsx)(n.li,{children:"For cryptographic operations, they share a quota"}),"\n",(0,i.jsx)(n.li,{children:"This includes requests made by AWS on your behalf (ex: SSE-KMS)"}),"\n",(0,i.jsx)(n.li,{children:"For GenerateDataKey, consider using DEK caching from the Encryption SDK"}),"\n",(0,i.jsx)(n.li,{children:"You can request a Request Quotas increase through API or AWS support"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"kms-request-quotas",src:s(72182).A+"",width:"599",height:"278"})}),"\n",(0,i.jsx)(n.h3,{id:"s3-bucket-key-for-sse-kms-encryption",children:"S3 Bucket Key for SSE-KMS encryption"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["New setting to decrease\u2026","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Number of API calls made to KMS from S3 by 99%"}),"\n",(0,i.jsx)(n.li,{children:"Costs of overall KMS encryption with Amazon S3 by 99%"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["This leverages data keys","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"A \u201cS3 bucket key\u201d is generated"}),"\n",(0,i.jsx)(n.li,{children:"That key is used to encrypt KMS objects with new data keys"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"You will see less KMS CloudTrail events in CloudTrail"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"s3-bucket-key",src:s(44646).A+"",width:"278",height:"277"})}),"\n",(0,i.jsx)(n.h3,{id:"key-policy--examples",children:"Key Policy \u2013 Examples"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"key-policy-example",src:s(70588).A+"",width:"600",height:"243"})}),"\n",(0,i.jsx)(n.h3,{id:"principal-options-in-iam-policies",children:"Principal Options in IAM Policies"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.img,{alt:"principal-options",src:s(83958).A+"",width:"621",height:"242"}),"\n",(0,i.jsx)(n.img,{alt:"principal-options2",src:s(12598).A+"",width:"600",height:"267"})]}),"\n",(0,i.jsx)(n.h2,{id:"cloudhsm",children:"CloudHSM"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"KMS => AWS manages the software for encryption"}),"\n",(0,i.jsx)(n.li,{children:"CloudHSM => AWS provisions encryption hardware"}),"\n",(0,i.jsx)(n.li,{children:"Dedicated Hardware (HSM = Hardware Security Module)"}),"\n",(0,i.jsx)(n.li,{children:"You manage your own encryption keys entirely (not AWS)"}),"\n",(0,i.jsx)(n.li,{children:"HSM device is tamper resistant, FIPS 140-2 Level 3 compliance"}),"\n",(0,i.jsx)(n.li,{children:"Supports both symmetric and asymmetric encryption (SSL/TLS keys)"}),"\n",(0,i.jsx)(n.li,{children:"No free tier available"}),"\n",(0,i.jsx)(n.li,{children:"Must use the CloudHSM Client Software"}),"\n",(0,i.jsx)(n.li,{children:"Redshift supports CloudHSM for database encryption and key management"}),"\n",(0,i.jsx)(n.li,{children:"Good option to use with SSE-C encryption"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"cloud-hsm",src:s(87821).A+"",width:"549",height:"284"})}),"\n",(0,i.jsx)(n.h3,{id:"high-availability",children:"High Availability"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"CloudHSM clusters are spread across Multi AZ (HA)"}),"\n",(0,i.jsx)(n.li,{children:"Great for availability and durability"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"integration-with-aws-services",children:"Integration with AWS Services"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Through integration with AWS KMS"}),"\n",(0,i.jsx)(n.li,{children:"Configure KMS Custom Key Store with CloudHSM"}),"\n",(0,i.jsx)(n.li,{children:"Example: EBS, S3, RDS \u2026"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"cloudhsm-integration",src:s(71613).A+"",width:"255",height:"279"})}),"\n",(0,i.jsx)(n.h3,{id:"cloudhsm-vs-kms",children:"CloudHSM vs. KMS"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.img,{alt:"cloudhsm-vs-kms",src:s(99402).A+"",width:"580",height:"269"}),"\n",(0,i.jsx)(n.img,{alt:"cloudhsm-vs-kms2",src:s(47554).A+"",width:"579",height:"120"})]}),"\n",(0,i.jsx)(n.h2,{id:"ssm-parameter-store",children:"SSM Parameter Store"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Secure storage for configuration and secrets"}),"\n",(0,i.jsx)(n.li,{children:"Optional Seamless Encryption using KMS"}),"\n",(0,i.jsx)(n.li,{children:"Serverless, scalable, durable, easy SDK"}),"\n",(0,i.jsx)(n.li,{children:"Version tracking of configurations / secrets"}),"\n",(0,i.jsx)(n.li,{children:"Security through IAM"}),"\n",(0,i.jsx)(n.li,{children:"Notifications with Amazon EventBridge"}),"\n",(0,i.jsx)(n.li,{children:"Integration with CloudFormation"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"ssm-parameter-store",src:s(21220).A+"",width:"233",height:"367"})}),"\n",(0,i.jsx)(n.h3,{id:"hierarchy",children:"Hierarchy"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"ssm-hierarchy",src:s(97936).A+"",width:"608",height:"258"})}),"\n",(0,i.jsx)(n.h3,{id:"standard-and-advanced-parameter-tiers",children:"Standard and advanced parameter tiers"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"ssm-tiers",src:s(33086).A+"",width:"610",height:"212"})}),"\n",(0,i.jsx)(n.h3,{id:"parameters-policies-for-advanced-parameters",children:"Parameters Policies (for advanced parameters)"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Allow to assign a TTL to a parameter (expiration date) to force updating or deleting sensitive data such as passwords"}),"\n",(0,i.jsx)(n.li,{children:"Can assign multiple policies at a time"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"parameter-policies",src:s(53277).A+"",width:"633",height:"116"})}),"\n",(0,i.jsx)(n.h2,{id:"aws-secrets-manager",children:"AWS Secrets Manager"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Newer service, meant for storing secrets"}),"\n",(0,i.jsx)(n.li,{children:"Capability to force rotation of secrets every X days"}),"\n",(0,i.jsx)(n.li,{children:"Automate generation of secrets on rotation (uses Lambda)"}),"\n",(0,i.jsx)(n.li,{children:"Integration with Amazon RDS (MySQL, PostgreSQL, Aurora)"}),"\n",(0,i.jsx)(n.li,{children:"Secrets are encrypted using KMS"}),"\n",(0,i.jsx)(n.li,{children:"Mostly meant for RDS integration"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"multi-region-secrets",children:"Multi-Region Secrets"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Replicate Secrets across multiple AWS Regions"}),"\n",(0,i.jsx)(n.li,{children:"Secrets Manager keeps read replicas in sync with the primary Secret"}),"\n",(0,i.jsx)(n.li,{children:"Ability to promote a read replica Secret to a standalone Secret"}),"\n",(0,i.jsx)(n.li,{children:"Use cases: multi-region apps, disaster recovery strategies, multi-region DB\u2026"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"multi-region-secrets",src:s(55765).A+"",width:"549",height:"144"})}),"\n",(0,i.jsx)(n.h2,{id:"ssm-parameter-store-vs-secrets-manager",children:"SSM Parameter Store vs Secrets Manager"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Secrets Manager ($$$):","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Automatic rotation of secrets with AWS Lambda"}),"\n",(0,i.jsx)(n.li,{children:"Lambda function is provided for RDS, Redshift, DocumentDB"}),"\n",(0,i.jsx)(n.li,{children:"KMS encryption is mandatory"}),"\n",(0,i.jsx)(n.li,{children:"Can integration with CloudFormation"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["SSM Parameter Store ($):","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Simple API"}),"\n",(0,i.jsx)(n.li,{children:"No secret rotation (can enable rotation using Lambda triggered by EventBridge)"}),"\n",(0,i.jsx)(n.li,{children:"KMS encryption is optional"}),"\n",(0,i.jsx)(n.li,{children:"Can integration with CloudFormation"}),"\n",(0,i.jsx)(n.li,{children:"Can pull a Secrets Manager secret using the SSM Parameter Store API"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"rotation",children:"Rotation"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"ssm-vs-secret-manager",src:s(94041).A+"",width:"643",height:"263"})}),"\n",(0,i.jsx)(n.h2,{id:"cloudformation--dynamic-references",children:"CloudFormation \u2013 Dynamic References"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.img,{alt:"cloudformation-dynamic-references",src:s(16642).A+"",width:"627",height:"310"}),"\n",(0,i.jsx)(n.img,{alt:"cloudformation-dynamic-references2",src:s(31754).A+"",width:"606",height:"278"})]}),"\n",(0,i.jsx)(n.h3,{id:"option-1--managemasteruserpassword",children:"Option 1 \u2013 ManageMasterUserPassword"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"ManageMasterUserPassword \u2013 creates admin secret implicitly"}),"\n",(0,i.jsx)(n.li,{children:"RDS, Aurora will manage the secret in Secrets Manager and its rotation"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"manage-master-passwords",src:s(22608).A+"",width:"641",height:"177"})}),"\n",(0,i.jsx)(n.h3,{id:"option-2--dynamic-reference",children:"Option 2 \u2013 Dynamic Reference"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"dynamic-reference",src:s(53106).A+"",width:"648",height:"259"})}),"\n",(0,i.jsx)(n.h2,{id:"cloudwatch-logs---encryption",children:"CloudWatch Logs - Encryption"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"You can encrypt CloudWatch logs with KMS keys"}),"\n",(0,i.jsx)(n.li,{children:"Encryption is enabled at the log group level, by associating a CMK with a log group, either when you create the log group or after it exists."}),"\n",(0,i.jsx)(n.li,{children:"You cannot associate a CMK with a log group using the CloudWatch console."}),"\n",(0,i.jsxs)(n.li,{children:["You must use the CloudWatch Logs API:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"associate-kms-key : if the log group already exists"}),"\n",(0,i.jsx)(n.li,{children:"create-log-group: if the log group doesn\u2019t exist yet"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"codebuild-security",children:"CodeBuild Security"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"To access resources in your VPC, make sure you specify a VPC configuration for your CodeBuild"}),"\n",(0,i.jsx)(n.li,{children:"Secrets in CodeBuild:"}),"\n",(0,i.jsx)(n.li,{children:"Don\u2019t store them as plaintext in environment variables"}),"\n",(0,i.jsxs)(n.li,{children:["Instead\u2026","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Environment variables can reference parameter store parameters"}),"\n",(0,i.jsx)(n.li,{children:"Environment variables can reference secrets manager secrets"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"aws-nitro-enclaves",children:"AWS Nitro Enclaves"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Process highly sensitive data in an isolated compute environment","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Personally Identifiable Information (PII), healthcare, financial, \u2026"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Fully isolated virtual machines, hardened, and highly constrained","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Not a container, not persistent storage, no interactive access, no external networking"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Helps reduce the attack surface for sensitive data processing apps","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Cryptographic Attestation \u2013 only authorized code can be running in your Enclave"}),"\n",(0,i.jsx)(n.li,{children:"Only Enclaves can access sensitive data (integration with KMS)"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"Use cases: securing private keys, processing credit cards, secure multi-party\ncomputation\u2026"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"aws-nitro-enclave",src:s(66864).A+"",width:"600",height:"283"})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},66864:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/aws-nitro-enclave-6c6738c61cc2cc041598ba1489d08ba9.png"},87821:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/cloud-hsm-2c8e9fd50b987d9b229b1982af2c7086.png"},16642:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/cloudformation-dynamic-references-05781f74d3e4dc1f6e41699ae7da46cf.png"},31754:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/cloudformation-dynamic-references2-bf373824aea64202a23cfdb64f907584.png"},71613:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/cloudhsm-integration-4d0bee6b2fb237e7cc13c63ab5102674.png"},99402:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/cloudhsm-vs-kms-c36dec1d81ff8d3c5d65aaa643352c3a.png"},47554:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/cloudhsm-vs-kms2-62c0fec34b2b85c056ff0b2b59add7c8.png"},52640:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/decrypt-envelope-data-cdbaabcb21c13d66af6ce6c925220797.png"},53106:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/dynamic-reference-f199a0f4b273c578d5b09ea8fe110acf.png"},59623:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/envelope-encryption-490d0c2de79c8ea11f5b8603848a1b6b.png"},70588:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/key-policy-example-4e9fa656b7af17c8b7367c115e96156d.png"},94008:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/kms-copying-snapshots-9f42e5670821916e1f1d05d581710093.png"},55726:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/kms-encrypt-decrypt-c093cd3f88d400c02b071a0516e7ce4e.png"},72182:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/kms-request-quotas-7617f89fef8a36398e54fa78e83375a2.png"},22608:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/manage-master-passwords-fa6a7abcbabdda10abf9ac107defbd06.png"},55765:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/multi-region-secrets-efd76d18fee699cddc51d85bda493056.png"},53277:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/parameter-policies-3a1e80ac6434e02279fa594fb1dbf60a.png"},83958:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/principal-options-ce3f62626422c1a8355c62b9d72e1b73.png"},12598:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/principal-options2-a083740a915e3372d89f4a9ac1057584.png"},44646:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/s3-bucket-key-0b3f6c3fbe0a3c48d34745550b886632.png"},97936:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/ssm-hierarchy-3fd24c1450e2b2af85f9465b1d9323dd.png"},21220:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/ssm-parameter-store-6356932a4e178712b8b2f646ad6673a6.png"},33086:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/ssm-tiers-d4d0ac002a794c86affb377e70b33ddb.png"},94041:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/ssm-vs-secret-manager-3ab88915a88d9685a24d340b13ede409.png"},28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>l});var i=s(96540);const r={},t=i.createContext(r);function a(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);